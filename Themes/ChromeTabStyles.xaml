<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:system="clr-namespace:System;assembly=mscorlib">
    
    <!-- Tab Dimension Resources -->
    <system:Double x:Key="PinnedTabWidth">45</system:Double>
    <system:Double x:Key="MinRegularTabWidth">120</system:Double>
    <system:Double x:Key="MaxRegularTabWidth">250</system:Double>
    <system:Double x:Key="TabHeight">32</system:Double>
    
    <!-- Ultra-modern Chrome-style close button -->
    <Style x:Key="ChromeCloseButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FontSize" Value="10"/>
        <Setter Property="Foreground" Value="#6E7681"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Border" 
                            Background="{TemplateBinding Background}"
                            CornerRadius="4"
                            Padding="2"
                            RenderTransformOrigin="0.5,0.5">
                        <Border.Effect>
                            <DropShadowEffect x:Name="ButtonShadow"
                                            Color="#FF000000"
                                            Direction="270"
                                            ShadowDepth="0"
                                            BlurRadius="0"
                                            Opacity="0"/>
                        </Border.Effect>
                        <Border.RenderTransform>
                            <ScaleTransform x:Name="ButtonScale" ScaleX="1" ScaleY="1"/>
                        </Border.RenderTransform>
                        
                        <!-- Modern close icon using Path instead of text -->
                        <Path x:Name="CloseIcon"
                              Width="8" Height="8"
                              Stretch="Uniform"
                              Stroke="{TemplateBinding Foreground}"
                              StrokeThickness="1.5"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="M 0,0 L 8,8 M 8,0 L 0,8"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <!-- Hover animation -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="Border"
                                                      Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                      To="#FF6A73" Duration="0:0:0.15"/>
                                        <ColorAnimation Storyboard.TargetName="CloseIcon"
                                                      Storyboard.TargetProperty="(Path.Stroke).(SolidColorBrush.Color)"
                                                      To="#FFFFFF" Duration="0:0:0.15"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonScale"
                                                       Storyboard.TargetProperty="ScaleX"
                                                       To="1.1" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseOut" Amplitude="0.3"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="ButtonScale"
                                                       Storyboard.TargetProperty="ScaleY"
                                                       To="1.1" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseOut" Amplitude="0.3"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="ShadowDepth"
                                                       To="2" Duration="0:0:0.15"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="BlurRadius"
                                                       To="4" Duration="0:0:0.15"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="Opacity"
                                                       To="0.2" Duration="0:0:0.15"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="Border"
                                                      Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                      To="Transparent" Duration="0:0:0.2"/>
                                        <ColorAnimation Storyboard.TargetName="CloseIcon"
                                                      Storyboard.TargetProperty="(Path.Stroke).(SolidColorBrush.Color)"
                                                      To="#6E7681" Duration="0:0:0.2"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonScale"
                                                       Storyboard.TargetProperty="ScaleX"
                                                       To="1.0" Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseIn" Amplitude="0.3"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="ButtonScale"
                                                       Storyboard.TargetProperty="ScaleY"
                                                       To="1.0" Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseIn" Amplitude="0.3"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="ShadowDepth"
                                                       To="0" Duration="0:0:0.2"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="BlurRadius"
                                                       To="0" Duration="0:0:0.2"/>
                                        <DoubleAnimation Storyboard.TargetName="ButtonShadow"
                                                       Storyboard.TargetProperty="Opacity"
                                                       To="0" Duration="0:0:0.2"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                        
                        <!-- Pressed animation -->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="Border" Property="Background">
                                <Setter.Value>
                                    <SolidColorBrush Color="#E63946"/>
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="CloseIcon" Property="Stroke" Value="#FFFFFF"/>
                            <Setter TargetName="Border" Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="0.95" ScaleY="0.95"/>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        
                        <!-- Disabled state -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="CloseIcon" Property="Stroke" Value="#D0D7DE"/>
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Enhanced Chrome-style pinned tab template with better visual feedback -->
    <ControlTemplate x:Key="ChromePinnedTabTemplate" TargetType="{x:Type TabItem}">
        <Border x:Name="TabBorder"
                Background="{StaticResource TabInactiveGradient}"
                BorderBrush="#0078D4"
                BorderThickness="1,1,1,0"
                CornerRadius="8,8,0,0"
                Margin="2,3,2,-1"
                Padding="0"
                Width="{StaticResource PinnedTabWidth}"
                MinWidth="{StaticResource PinnedTabWidth}"
                MaxWidth="{StaticResource PinnedTabWidth}"
                Height="{StaticResource TabHeight}"
                RenderTransformOrigin="0.5,0.5">
            <Border.RenderTransform>
                <ScaleTransform x:Name="TabScale" ScaleX="1" ScaleY="1"/>
            </Border.RenderTransform>
            <Border.Effect>
                <DropShadowEffect x:Name="TabShadow" 
                                Color="#0078D4" 
                                Direction="270" 
                                ShadowDepth="3" 
                                BlurRadius="8" 
                                Opacity="0.3"/>
            </Border.Effect>
            
            <!-- Enhanced pinned content with better visual indicator -->
            <Grid>
                <!-- Pin indicator background -->
                <Ellipse x:Name="PinBackground"
                        Width="24" Height="24"
                        Fill="#0078D4"
                        Opacity="0.15"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                
                <!-- Pin icon with enhanced visibility -->
                <TextBlock x:Name="PinIcon"
                          Text="📌"
                          FontSize="16"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Foreground="#0078D4"
                          FontWeight="Bold"
                          RenderTransformOrigin="0.5,0.5">
                    <TextBlock.RenderTransform>
                        <RotateTransform Angle="0"/>
                    </TextBlock.RenderTransform>
                </TextBlock>
                
                <!-- Tooltip for better UX -->
                <Grid.ToolTip>
                    <ToolTip>
                        <StackPanel>
                            <TextBlock Text="{Binding Tag.Title, RelativeSource={RelativeSource TemplatedParent}}" 
                                      FontWeight="Bold"/>
                            <TextBlock Text="Pinned Tab - Right-click to unpin" 
                                      FontSize="11" 
                                      Foreground="Gray"/>
                        </StackPanel>
                    </ToolTip>
                </Grid.ToolTip>
            </Grid>
        </Border>
        
        <ControlTemplate.Triggers>
            <!-- Hover effect for pinned tabs -->
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="TabBorder" Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#F0F8FF" Offset="0"/>
                            <GradientStop Color="#E6F3FF" Offset="1"/>
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="PinBackground" Property="Opacity" Value="0.25"/>
                <!-- Note: Can't directly target TabShadow as it's inside Border.Effect -->
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="TabScale"
                                           Storyboard.TargetProperty="ScaleX"
                                           To="1.05"
                                           Duration="0:0:0.15"/>
                            <DoubleAnimation Storyboard.TargetName="TabScale"
                                           Storyboard.TargetProperty="ScaleY"
                                           To="1.05"
                                           Duration="0:0:0.15"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="TabScale"
                                           Storyboard.TargetProperty="ScaleX"
                                           To="1.0"
                                           Duration="0:0:0.15"/>
                            <DoubleAnimation Storyboard.TargetName="TabScale"
                                           Storyboard.TargetProperty="ScaleY"
                                           To="1.0"
                                           Duration="0:0:0.15"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
            
            <!-- Selected State with enhanced styling -->
            <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="TabBorder" Property="Background" Value="White"/>
                <Setter TargetName="TabBorder" Property="BorderBrush" Value="#0078D4"/>
                <Setter TargetName="TabBorder" Property="BorderThickness" Value="3,3,3,0"/>
                <Setter TargetName="PinIcon" Property="Foreground" Value="#0078D4"/>
                <Setter TargetName="PinBackground" Property="Fill" Value="#0078D4"/>
                <Setter TargetName="PinBackground" Property="Opacity" Value="0.2"/>
                <Setter Property="Panel.ZIndex" Value="2"/>
            </Trigger>
            
            <!-- Loading state for pinned tabs -->
            <DataTrigger Binding="{Binding Tag.IsLoading, RelativeSource={RelativeSource Self}}" Value="True">
                <Setter TargetName="PinIcon" Property="Text" Value="⟳"/>
                <DataTrigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <DoubleAnimation Storyboard.TargetName="PinIcon"
                                           Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                                           From="0"
                                           To="360"
                                           Duration="0:0:1"/>
                        </Storyboard>
                    </BeginStoryboard>
                </DataTrigger.EnterActions>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Tab Drop Zone Style -->
    <Style TargetType="{x:Type local:TabDropZone}" xmlns:local="clr-namespace:ExplorerPro.UI.Controls">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:TabDropZone}">
                    <Grid>
                        <Rectangle Width="3" Height="30"
                                 Fill="#0078D4"
                                 RadiusX="1.5" RadiusY="1.5">
                            <Rectangle.Effect>
                                <DropShadowEffect Color="#0078D4" 
                                                BlurRadius="8" 
                                                ShadowDepth="0"
                                                Opacity="0.8"/>
                            </Rectangle.Effect>
                        </Rectangle>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Opacity" Value="0"/>
    </Style>

    <!-- Enhanced Chrome Tab Style with Drag Animations -->
    <Style x:Key="ChromeTabItemStyle" TargetType="{x:Type TabItem}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Border x:Name="TabBorder"
                            Background="{StaticResource TabInactiveGradient}"
                            BorderBrush="#D0D7DE"
                            BorderThickness="1,1,1,0"
                            CornerRadius="8,8,0,0"
                            Margin="2,3,2,-1"
                            Padding="8,6,32,6"
                            Height="{StaticResource TabHeight}"
                            MinWidth="{StaticResource MinRegularTabWidth}"
                            MaxWidth="{StaticResource MaxRegularTabWidth}"
                            RenderTransformOrigin="0.5,0.5">
                        <Border.RenderTransform>
                            <ScaleTransform x:Name="TabScale" ScaleX="1" ScaleY="1"/>
                        </Border.RenderTransform>
                        <Border.Effect>
                            <DropShadowEffect x:Name="TabShadow" 
                                            Color="#FF000000" 
                                            Direction="270" 
                                            ShadowDepth="2" 
                                            BlurRadius="6" 
                                            Opacity="0.1"/>
                        </Border.Effect>
                        
                        <Grid>
                            <ContentPresenter x:Name="ContentSite"
                                            ContentSource="Header"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"/>
                            
                            <!-- Close button with clear single X visual -->
                            <Button x:Name="CloseButton"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Width="16"
                                    Height="16"
                                    Margin="4,0,8,0"
                                    Cursor="Hand"
                                    Tag="{Binding}"
                                    Visibility="{Binding CanClose, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="Border"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="2">
                                            <Path x:Name="XPath"
                                                  Width="8" 
                                                  Height="8"
                                                  Stretch="Uniform"
                                                  StrokeThickness="1.5"
                                                  Stroke="#666666"
                                                  Data="M 0,0 L 8,8 M 8,0 L 0,8"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="#E81123"/>
                                                <Setter TargetName="XPath" Property="Stroke" Value="White"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="#F1707A"/>
                                                <Setter TargetName="XPath" Property="Stroke" Value="White"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <!-- Selected State -->
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="TabBorder" Property="Background" Value="White"/>
                            <Setter TargetName="TabBorder" Property="BorderBrush" Value="#0078D4"/>
                            <Setter Property="Panel.ZIndex" Value="2"/>
                        </Trigger>
                        
                        <!-- Enhanced Dragging State -->
                        <DataTrigger Binding="{Binding Tag.IsDragging, RelativeSource={RelativeSource Self}}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                       To="0.3" Duration="0:0:0.15"/>
                                        <DoubleAnimation Storyboard.TargetName="TabScale"
                                                       Storyboard.TargetProperty="ScaleX"
                                                       To="0.95" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="TabScale"
                                                       Storyboard.TargetProperty="ScaleY"
                                                       To="0.95" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                       To="1.0" Duration="0:0:0.15"/>
                                        <DoubleAnimation Storyboard.TargetName="TabScale"
                                                       Storyboard.TargetProperty="ScaleX"
                                                       To="1.0" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseIn"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetName="TabScale"
                                                       Storyboard.TargetProperty="ScaleY"
                                                       To="1.0" Duration="0:0:0.15">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseIn"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                        
                        <!-- Drop Target Highlighting -->
                        <DataTrigger Binding="{Binding Tag.IsDropTarget, RelativeSource={RelativeSource Self}}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="TabBorder"
                                                      Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                      To="#E3F2FD" Duration="0:0:0.2"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="TabBorder"
                                                      Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                      Duration="0:0:0.2"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary> 